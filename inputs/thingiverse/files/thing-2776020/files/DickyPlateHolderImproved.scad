
// fudge value is used to ensure that subtracted solids are a tad taller
// in the z dimension than the polygon being subtracted from.  This helps
// keep the resulting .stl file manifold.
fudge = 0.1;

//Smoothing
$fn=20;

//Height
hi = 8;

//Radius of the bars
bar_radius = 25.4 / 2;

//Bar notch shift to tweak (-18)
notch_shift = -24;

//Bolt length (whatever)
bolt_length = 200;

//Bolt radius
bolt_radius = 5 / 2;

//Nut thickness
nut_thick = 3;

//Nut width
nut_width = 7;

//Scale along x (0.35)
x_squish = 0.65;

//Scale along y (0.5)
y_squish = 0.7;


module poly_path4211(h) //Curvy bit drawn as vector and exported with https://www.thingiverse.com/thing:25036
{
  scale([25.4/90, -25.4/90, 1]) union()
  {
    linear_extrude(height=h)
      polygon([[-2.036737,-80.831214],[-4.804049,-80.483477],[-7.354371,-79.442278],[-9.697826,-77.753565],[-11.844536,-75.463291],[-13.804622,-72.617405],[-15.588208,-69.261857],[-17.205416,-65.442598],[-18.666366,-61.205579],[-21.159987,-51.662062],[-23.150049,-40.998907],[-24.717528,-29.583720],[-25.943402,-17.784104],[-27.694246,5.498003],[-29.050400,25.906584],[-29.782912,34.114294],[-30.659684,40.500811],[-31.761693,44.698533],[-32.422467,45.861720],[-33.169917,46.339856],[-34.015778,46.320631],[-34.720894,45.997372],[-35.755512,44.517718],[-36.367014,42.058833],[-36.648641,38.778657],[-36.595244,30.386189],[-36.341261,20.603827],[-36.632632,10.695085],[-37.215932,6.088169],[-38.215299,1.923477],[-39.723974,-1.641055],[-41.835200,-4.447484],[-43.145908,-5.517055],[-44.642220,-6.337874],[-46.335792,-6.890198],[-48.238277,-7.154284],[-50.162748,-7.105030],[-51.919994,-6.744155],[-53.518247,-6.092151],[-54.965741,-5.169509],[-57.441377,-2.594272],[-59.412763,0.817624],[-60.945758,4.902250],[-62.106224,9.495679],[-63.573005,19.553224],[-64.934048,38.561047],[-65.330884,42.126069],[-65.882071,44.888459],[-66.653469,46.684288],[-67.142328,47.168514],[-67.710937,47.349626],[-68.770178,46.908037],[-69.539578,45.576012],[-70.074026,43.479020],[-70.428410,40.742527],[-71.143062,25.910875],[-71.847091,17.920174],[-72.477889,14.220239],[-73.367727,10.884536],[-74.571492,8.038531],[-76.144074,5.807692],[-78.140360,4.317485],[-80.615237,3.693376],[-81.993758,3.869341],[-83.386104,4.524072],[-84.776158,5.623975],[-86.147801,7.135450],[-88.771377,11.258730],[-91.127883,16.625135],[-93.088369,22.965886],[-94.523884,30.012205],[-95.305480,37.495314],[-95.304206,45.146434],[-94.391112,52.696787],[-93.552336,56.350182],[-92.437249,59.877594],[-91.029732,63.245425],[-89.313666,66.420078],[-87.272933,69.367956],[-84.891414,72.055461],[-82.152990,74.448996],[-79.041543,76.514963],[-75.540954,78.219766],[-71.635103,79.529807],[-67.307873,80.411489],[-62.543144,80.831214],[-57.324799,80.755386],[-51.636717,80.150406],[-45.939384,78.357846],[-40.062604,77.046858],[-33.992430,76.106380],[-27.714916,75.425347],[-14.482083,74.397366],[-0.252537,73.074406],[14.055928,74.397366],[27.462382,75.425347],[33.832625,76.106380],[39.983691,77.046858],[45.917688,78.357846],[51.636723,80.150406],[57.324805,80.755386],[62.543150,80.831214],[67.307879,80.411489],[71.635109,79.529807],[75.540959,78.219766],[79.041548,76.514963],[82.152995,74.448996],[84.891418,72.055461],[87.272937,69.367956],[89.313670,66.420078],[91.029735,63.245425],[92.437251,59.877594],[93.552338,56.350182],[94.391114,52.696787],[95.304207,45.146434],[95.305480,37.495314],[94.523883,30.012205],[93.088367,22.965886],[91.127881,16.625135],[88.771374,11.258730],[86.147797,7.135450],[84.776155,5.623975],[83.386100,4.524072],[81.993754,3.869341],[80.615233,3.693376],[78.140356,4.317485],[76.144070,5.807692],[74.571488,8.038531],[73.367723,10.884536],[72.477885,14.220239],[71.847087,17.920174],[71.143059,25.910875],[70.428410,40.742527],[70.074027,43.479020],[69.539581,45.576012],[68.770182,46.908037],[67.710943,47.349626],[67.142333,47.168514],[66.653473,46.684288],[65.882074,44.888459],[65.330886,42.126069],[64.934049,38.561047],[63.573007,19.553224],[62.106227,9.495679],[60.945762,4.902250],[59.412767,0.817624],[57.441382,-2.594272],[54.965746,-5.169509],[53.518253,-6.092151],[51.920000,-6.744155],[50.162754,-7.105030],[48.238283,-7.154284],[46.333177,-6.888917],[44.632083,-6.332918],[43.123853,-5.506277],[41.797338,-4.428984],[39.644863,-1.602402],[38.085471,1.986907],[37.029979,6.179020],[36.389201,10.814017],[35.995044,20.772975],[36.189520,30.584409],[36.259147,38.968948],[36.024178,42.226329],[35.490441,44.647221],[34.568752,46.071704],[33.934554,46.360317],[33.169923,46.339856],[32.373811,45.804996],[31.646692,44.594018],[30.363991,40.325401],[29.250930,33.897391],[28.236618,25.673373],[26.220681,5.290854],[23.749059,-17.915073],[22.165140,-29.668351],[20.254629,-41.037325],[17.946635,-51.658611],[15.170267,-61.168821],[11.854637,-69.204572],[9.972445,-72.555968],[7.928853,-75.402478],[5.715000,-77.698681],[3.322025,-79.399154],[0.741066,-80.458472],[-2.036737,-80.831214]]);
  }
}



difference(){
    //Bring in the polygon from Inkscape with arbitrary scale...
    scale([x_squish,y_squish,1]) poly_path4211(hi);

    //Notch out for common bar diameters 
    translate([0,notch_shift,0]) #cylinder(h=hi, r=bar_radius);
    
    //Notch out for bolt
    translate ([0,0,hi/2]) rotate([90,0,0]) #cylinder(h=bolt_length, r=bolt_radius, center=true);
    
    //Notch out for nut trap
    translate ([-nut_width/2,-4,(hi-nut_width)/2]) #cube([nut_width,nut_thick,bolt_length]);
    
}//end difference
