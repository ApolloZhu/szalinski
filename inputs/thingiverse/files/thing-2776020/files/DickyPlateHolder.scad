
// fudge value is used to ensure that subtracted solids are a tad taller
// in the z dimension than the polygon being subtracted from.  This helps
// keep the resulting .stl file manifold.
fudge = 0.1;

//Smoothing
$fn=20;

//Height
hi = 8;

//Radius of the bars
bar_radius = 25.4 / 2;

//Bar notch shift to tweak (-18)
notch_shift = -18;

//Bolt length (whatever)
bolt_length = 200;

//Bolt radius
bolt_radius = 5 / 2;

//Nut thickness
nut_thick = 3;

//Nut width
nut_width = 7;

//Scale along x (0.35)
x_squish = 0.35;

//Scale along y (0.5)
y_squish = 0.5;


module poly_path41363(h) //Curvy bit drawn as vector and exported with https://www.thingiverse.com/thing:25036
{
  scale([25.4/90, -25.4/90, 1]) union()
  {
    linear_extrude(height=h)
      polygon([[37.363225,-74.226732],[37.363225,-35.840942],[38.480245,-26.362684],[40.461475,-17.507401],[43.270197,-9.273511],[46.869693,-1.659429],[51.223243,5.336428],[56.294131,11.715643],[62.045637,17.479799],[68.441043,22.630480],[75.443630,27.169268],[83.016680,31.097748],[91.123475,34.417502],[99.727296,37.130115],[108.791425,39.237168],[118.279144,40.740246],[128.153733,41.640932],[138.378475,41.940808],[139.457596,41.446563],[141.146060,40.097442],[143.102438,38.093873],[144.985304,35.636278],[146.453230,32.925085],[147.164788,30.160717],[147.130234,28.821225],[146.778553,27.543600],[146.067066,26.352893],[144.953095,25.274158],[142.014369,22.617386],[139.944666,19.870623],[138.675990,17.095690],[138.140340,14.354403],[138.269721,11.708583],[138.996132,9.220048],[140.251577,6.950616],[141.968056,4.962106],[144.077572,3.316337],[146.512127,2.075127],[149.203722,1.300296],[152.084359,1.053662],[155.086040,1.397043],[158.140767,2.392259],[161.180541,4.101128],[164.137365,6.585468],[169.731459,12.734999],[174.120853,18.729263],[177.373353,24.543913],[179.556766,30.154599],[180.738898,35.536972],[180.987557,40.666684],[180.370550,45.519384],[178.955683,50.070725],[176.810762,54.296356],[174.003595,58.171930],[170.601989,61.673096],[166.673751,64.775507],[162.286686,67.454812],[157.508602,69.686664],[152.407306,71.446712],[147.050605,72.710608],[138.835410,73.814925],[130.270192,74.226732],[121.426415,74.031376],[112.375543,73.314203],[103.189040,72.160562],[93.938371,70.655799],[75.530390,66.934295],[41.088852,59.033087],[26.198722,56.218937],[19.586441,55.394689],[13.624635,55.072788]]);
    linear_extrude(height=h)
      polygon([[13.624635,55.072788],[-13.624635,55.072788],[-19.586441,55.394689],[-26.198722,56.218937],[-41.088852,59.033087],[-75.530390,66.934295],[-93.938371,70.655799],[-103.189040,72.160562],[-112.375543,73.314203],[-121.426415,74.031376],[-130.270192,74.226732],[-138.835410,73.814925],[-147.050605,72.710608],[-152.407306,71.446712],[-157.508602,69.686664],[-162.286686,67.454812],[-166.673751,64.775507],[-170.601989,61.673096],[-174.003595,58.171930],[-176.810762,54.296356],[-178.955683,50.070725],[-180.370550,45.519384],[-180.987557,40.666684],[-180.738898,35.536972],[-179.556766,30.154599],[-177.373353,24.543913],[-174.120853,18.729263],[-169.731459,12.734999],[-164.137365,6.585468],[-161.180541,4.101128],[-158.140767,2.392259],[-155.086040,1.397043],[-152.084359,1.053662],[-149.203722,1.300296],[-146.512127,2.075127],[-144.077572,3.316337],[-141.968056,4.962106],[-140.251577,6.950616],[-138.996132,9.220048],[-138.269721,11.708583],[-138.140340,14.354403],[-138.675990,17.095690],[-139.944666,19.870623],[-142.014369,22.617386],[-144.953095,25.274158],[-146.067066,26.352893],[-146.778553,27.543600],[-147.130234,28.821225],[-147.164788,30.160717],[-146.453230,32.925085],[-144.985304,35.636278],[-143.102438,38.093873],[-141.146060,40.097442],[-139.457596,41.446563],[-138.378475,41.940808],[-128.153733,41.640932],[-118.279144,40.740246],[-108.791425,39.237168],[-99.727296,37.130115],[-91.123475,34.417502],[-83.016680,31.097748],[-75.443630,27.169268],[-68.441042,22.630480],[-62.045637,17.479799],[-56.294131,11.715643],[-51.223243,5.336428],[-46.869692,-1.659429],[-43.270197,-9.273511],[-40.461475,-17.507401],[-38.480245,-26.362684],[-37.363225,-35.840942],[-37.363225,-74.226732],[37.363225,-74.226732]]);
  }
}


difference(){
    //Bring in the polygon from Inkscape with arbitrary scale...
    scale([x_squish,y_squish,1]) poly_path41363(hi);

    //Notch out for common bar diameters 
    translate([0,notch_shift,0]) #cylinder(h=hi, r=bar_radius);
    
    //Notch out for bolt
    translate ([0,0,hi/2]) rotate([90,0,0]) #cylinder(h=bolt_length, r=bolt_radius, center=true);
    
    //Notch out for nut trap
    translate ([-nut_width/2,-4,(hi-nut_width)/2]) #cube([nut_width,nut_thick,bolt_length]);
    
}//end difference
